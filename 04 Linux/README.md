## 内存分布

Linux32位 **用户空间** 内存分布（低地址到高地址)

1. 程序代码区(code)
    存放函数体的二进制代码。一个C语言程序由多个函数构成，C语言程序的执行就是函数之间的相互调用。
2. 常量区(constant)
    存放一般的常量、字符串常量等。这块内存只有读取权限，没有写入权限，因此它们的值在程序运行期间不能改变。

3. 全局数据区(global data)
    存放全局变量、静态变量等。这块内存有读写权限，因此它们的值在程序运行期间可以任意改变。

4. 堆区(heap)
    一般由程序员分配和释放，若程序员不释放，程序运行结束时由操作系统回收。malloc()、calloc()、free() 等函数操作的就是这块内存，这也是本章要讲解的重点。

5. 动态链接库
    用于在程序运行期间加载和卸载动态链接库。

6. 栈区(stack)
    存放函数的参数值、局部变量的值等，其操作方式类似于数据结构中的栈。

---

Linux32位 **程序空间**

一个程序的本质都是由bss段、data段、text段三个组成的

1. BSS段（Block Started by Symbol：存放未初始化或者初始化为0的全局变量
    *bss段只占运行时的内存空间而不占可执行文件空间。在程序运行的整个周期内，.bss段的数据一直存在
    * 因为其内容由由内核初始化为0，裸机程序需要自行手动清零

2. DATA区（已初始化的数据段）：静态存储区，赋了初值的全局变量、常量和静态变量都存放在这个域
    1. 栈区（stack）：由编译器自动分配释放 ，存放函数的参数值，局部变量的值等。
    2. 静态存储区：全局变量和静态变量的存储是放在一块的， 未初始化的全局变量和未初始化的静态变量 在相邻的另一块区域。 在程序序结束后由系统释放。　　
    3. 堆区（heap）：
        一般由程序员分配释放， 若程序员不释放，在程序结束时，操作系统回收
        堆是操作系统所维护的一块特殊内存，它提供了动态分配的功能，当运行程序调用malloc()时就会从中分配，稍后调用free可把内存交还

3. 代码段（TXT）：在内存中被映射为只读，编译时确定, 但.data和.bss是可写的
    * 函数+成员函数的地方

## 内核模式/用户模式

内核空间存放的是OS内核代码和数据

用户模式访问内核空间：

    必须借助OS提供的API接口，执行内核提供的代码，让内核自己来访问，才能保证kernel数据不被随意修改。

系统调用：

    用户程序调系统API函数称为系统调用（system call）；
    系统调用时会发生用户程序暂停，转而执行内核代码（内核也是程序）。

